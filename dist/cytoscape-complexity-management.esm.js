import{ComplexityManager as e}from"cmgm";function t(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function o(e){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{};o%2?t(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function n(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(e,t,o){return(t=n(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,a,i,r,l=[],d=!0,c=!1;try{if(i=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;d=!1}else for(;!(d=(n=i.call(o)).done)&&(l.push(n.value),l.length!==t);d=!0);}catch(e){c=!0,a=e}finally{try{if(!d&&null!=o.return&&(r=o.return(),Object(r)!==r))return}finally{if(c)throw a}}return l}}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return c(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function s(t){var n=new e,a=t.nodes(),i=t.edges();!function e(t,o){for(var n=t.length,a=0;a<n;a++){var i=t[a],r=i.children();o.addNode(i.id(),i.parent().id()),null!=r&&r.length>0&&e(r,o)}}(function(e){var t={};return e.forEach((function(e){t[e.id()]=!0})),e.filter((function(e,o){"number"==typeof e&&(e=o);for(var n=e.parent()[0];null!=n;){if(t[n.id()])return!1;n=n.parent()[0]}return!0}))}(a),n),function(e,t){for(var o=0;o<e.length;o++){var n=e[o];t.addEdge(n.id(),n.source().id(),n.target().id())}}(i,n);var d=[],c=function(){d.forEach((function(e){if(n.visibleGraphManager.nodesMap.get(e.parent().id())){e.isNode()&&n.addNode(e.id(),e.parent().id());var t=d.indexOf(e);t>-1&&d.splice(t,1),b()}}))},s=function(e){var t=e.target;t.parent().id()?n.visibleGraphManager.nodesMap.get(t.parent().id())?(t.isNode()&&n.addNode(t.id(),t.parent().id()),b()):d.push(t):(t.isNode()?n.addNode(t.id(),t.parent().id()):(c(),n.addEdge(t.id(),t.source().id(),t.target().id())),b());c()},u=function(e){var t=e.target;t.isNode()?n.removeNode(t.id()):n.removeEdge(t.id()),b()};t.on("add",s),t.on("remove",u),t.on("move","edge",(function(e){var t=e.target;n.reconnect(t.id(),t.source().id(),t.target().id()),b()})),t.on("move","node",(function(e){var t=e.target;n.changeParent(t.id(),t.parent().id()),b()}));var p=new Set,f=function(){return t.scratch("cyComplexityManagement").options.filterRule},y=function(e,t){return new Set(l(e).filter((function(e){return!t.has(e)})))};function g(e,t){var o=t.collection();e.forEach((function(e){o.merge(t.getElementById(e))})),t.off("remove",u),t.remove(o).forEach((function(e){t.scratch("cyComplexityManagement").removedEles.set(e.id(),e)})),t.on("remove",u)}function m(e,t){return t.getElementById(e.data().parent).data()?t.getElementById(e.data().parent):e.parent().id()?m(e.parent(),t):void 0}function h(e,t){var o=t.collection(),n=t.collection();e.forEach((function(e){var a=t.scratch("cyComplexityManagement").removedEles.get(e);a&&(a.isNode()?o.merge(a):n.merge(a))})),t.off("add",s),o.forEach((function(e){var o,n,a,i,r,l,d=cyInvisible.getElementById(e.id());if(d.id()){var c=cyInvisible.getElementById(d.data().parent),s=m(d,t);if(s&&(s.id()!=c.id()&&(c=cyInvisible.getElementById(s.id())),s.position()&&e.isChildless())){var u=(o=d.position().x,n=d.position().y,a=c.position().x,i=c.position().y,r=s.position().x,l=s.position().y,{x:o+(r-a),y:n+(l-i)});e.position(u)}}})),t.add(o.merge(n)).forEach((function(e){t.scratch("cyComplexityManagement").removedEles.delete(e.id())})),t.on("add",s)}function v(e,t){t.off("add",s),e.forEach((function(e){try{t.add({group:"edges",data:{id:e.ID,source:e.sourceID,target:e.targetID,size:e.size,compound:e.compound}})}catch(e){}})),t.on("add",s)}function b(){var e=f(),o=new Set;t.elements().forEach((function(t){e(t)&&o.add(t.id())})),t.scratch("cyComplexityManagement").removedEles.forEach((function(t){e(t)&&o.add(t.id())}));var a=y(p,o);a.forEach((function(e){p.delete(e)}));var i=y(o,p);i.forEach((function(e){p.add(e)}));var l=[],d=[],c=[],s=[];i.forEach((function(e){t.getElementById(e).length>0&&t.getElementById(e).isNode()||t.scratch("cyComplexityManagement").removedEles.has(e)&&t.scratch("cyComplexityManagement").removedEles.get(e).isNode()?l.push(e):d.push(e)})),a.forEach((function(e){var o;null!==(o=t.scratch("cyComplexityManagement").removedEles.get(e))&&void 0!==o&&o.isNode()?c.push(e):s.push(e)}));var u=n.filter(l,d),m=r(n.unfilter(c,s),2),b=m[0],x=m[1];g(u,t),h(b,t),v(x,t)}var x={getCompMgrInstance:function(){return n},updateFilterRule:function(e){t.scratch("cyComplexityManagement").options.filterRule=e,b()},getHiddenNeighbors:function(e){var o=t.collection();return e.forEach((function(e){var a=n.getHiddenNeighbors(e.id());a.nodes.forEach((function(e){o.merge(t.scratch("cyComplexityManagement").removedEles.get(e))})),a.edges.forEach((function(e){o.merge(t.scratch("cyComplexityManagement").removedEles.get(e))}))})),o},hide:function(e){var o=[],a=[];e.forEach((function(e){e.isNode()?o.push(e.id()):a.push(e.id())})),g(n.hide(o,a),t)},show:function(e){var o=[],a=[];e.forEach((function(e){e.isNode()?o.push(e.id()):a.push(e.id())}));var i=r(n.show(o,a),2),l=i[0],d=i[1];h(l,t),v(d,t)},showAll:function(){var e=r(n.showAll(),2),o=e[0],a=e[1];h(o,t),v(a,t)},collapseNodes:function(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=[];e.forEach((function(e){n.isCollapsible(e.id())&&(a.push(e.id()),e.data("position-before-collapse",{x:e.position().x,y:e.position().y}),e.data("size-before-collapse",{w:e.outerWidth(),h:e.outerHeight()}),e.addClass("cy-expand-collapse-collapsed-node"))}));var i=n.collapseNodes(a,o),r=[],l=[];i.nodeIDListForInvisible.forEach((function(e){r.push(e)})),i.edgeIDListForInvisible.forEach((function(e){r.push(e)})),i.metaEdgeIDListForVisible.forEach((function(e){l.push(e)})),g(r,t),v(l,t)},expandNodes:function(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,d=[];e.forEach((function(e){n.isExpandable(e.id())&&(d.push(e.id()),a&&E(e.data().id,t,i,r),e.removeClass("cy-expand-collapse-collapsed-node"),e.removeData("position-before-collapse"),e.removeData("size-before-collapse"))})),setTimeout((function(){i.pngExpandGraph=t.png({scale:2,full:!0});var e=n.expandNodes(d,o);h(l(e.nodeIDListForVisible),t),e.nodeIDListForVisible.forEach((function(e){var o=t.getElementById(e);n.isCollapsible(o.id())?(o.removeClass("cy-expand-collapse-collapsed-node"),o.removeData("position-before-collapse"),o.removeData("size-before-collapse")):n.isExpandable(o.id())&&(o.data("position-before-collapse",{x:o.position().x,y:o.position().y}),o.data("size-before-collapse",{w:o.outerWidth(),h:o.outerHeight()}),o.addClass("cy-expand-collapse-collapsed-node"))})),h(l(e.edgeIDListForVisible),t),g(l(e.edgeIDListToRemove),t),v(l(e.metaEdgeIDListForVisible),t)}),a?600:0)},collapseAllNodes:function(){var e=n.collapseAllNodes(),o=[],a=[];e.nodeIDListForInvisible.forEach((function(e){o.push(e)})),e.collapsedNodes.forEach((function(e){var o=t.getElementById(e);o.data("position-before-collapse",{x:o.position().x,y:o.position().y}),o.data("size-before-collapse",{w:o.outerWidth(),h:o.outerHeight()}),o.addClass("cy-expand-collapse-collapsed-node")})),e.edgeIDListForInvisible.forEach((function(e){o.push(e)})),e.metaEdgeIDListForVisible.forEach((function(e){a.push(e)})),g(o,t),v(a,t)},expandAllNodes:function(){var e=n.expandAllNodes();h(l(e.nodeIDListForVisible),t),e.expandedNodes.forEach((function(e){var o=t.getElementById(e);o.removeClass("cy-expand-collapse-collapsed-node"),o.removeData("position-before-collapse"),o.removeData("size-before-collapse")})),h(l(e.edgeIDListForVisible),t);var o=[];t.edges('[compound = "T"]').forEach((function(e){n.visibleGraphManager.edgesMap.has(e.data().id)||o.push(e.data().id)})),g([].concat(l(e.edgeIDListToRemove),o),t)},collapseEdges:function(e){var o=new Map;e.forEach((function(e){var t=[e.source().id(),e.target().id()].sort().join("-");o.has(t)?o.get(t).push(e.id()):o.set(t,[e.id()])})),Array.from(o.values()).forEach((function(e){if(e.length>1){var o=n.collapseEdges(e);g(e,t),v(o,t)}}))},collapseEdgesBetweenNodes:function(e){var o=[];e.forEach((function(e){o.push(e.id())}));var a=n.collapseEdgesBetweenNodes(o);g(a[0],t),v(a[1],t)},collapseAllEdges:function(){var e=n.collapseAllEdges();g(e[0],t),v(e[1],t)},expandEdges:function(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=[];e.forEach((function(e){a.push(e.id())}));var i=n.expandEdges(a,o);g(i[2],t),h(i[0],t),v(i[1],t)},expandEdgesBetweenNodes:function(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=[];e.forEach((function(e){a.push(e.id())}));var i=n.expandEdgesBetweenNodes(a,o);g(i[2],t),h(i[0],t),v(i[1],t)},expandAllEdges:function(){var e=n.expandAllEdges();g(e[2],t),h(e[0],t),v(e[1],t)},isCollapsible:function(e){return n.isCollapsible(e.id())},isExpandable:function(e){return n.isExpandable(e.id())}},E=function(e,t,n,a){var i=I(instance.getCompMgrInstance("get").mainGraphManager.nodesMap.get(e));cyLayout.remove(cyLayout.elements()),cyLayout.add({group:"nodes",data:{id:e,parent:null,label:document.getElementById("cbk-flag-display-node-labels").checked?e:""},position:cyInvisible.getElementById(e).position()}).style({"background-color":"#CCE1F9"});var r=[];i.compoundNodes.forEach((function(e){0!=cyLayout.getElementById(e.owner.parent.ID).length?cyLayout.add({group:"nodes",data:{id:e.ID,parent:e.owner.parent.ID,label:document.getElementById("cbk-flag-display-node-labels").checked?e.ID:""},position:cyInvisible.getElementById(e.ID).position()}):r.push({group:"nodes",data:{id:e.ID,parent:e.owner.parent.ID,label:document.getElementById("cbk-flag-display-node-labels").checked?e.ID:""},position:cyInvisible.getElementById(e.ID).position()})})),r.forEach((function(e){cyLayout.add(e)})),i.simpleNodes.forEach((function(e){try{cyLayout.add({group:"nodes",data:{id:e.ID,parent:e.owner.parent.ID,label:document.getElementById("cbk-flag-display-node-labels").checked?e.ID:""},position:cyInvisible.getElementById(e.ID).position()})}catch(e){console.log(e)}})),l(i.edges).forEach((function(e){try{0==cyLayout.getElementById(e.source.ID).length?cyLayout.add({group:"nodes",data:{id:e.source.ID,label:document.getElementById("cbk-flag-display-node-labels").checked?e.source.ID:""},position:cyInvisible.getElementById(e.source.ID).position()}):0==cyLayout.getElementById(e.target.ID).length&&cyLayout.add({group:"nodes",data:{id:e.target.ID,label:document.getElementById("cbk-flag-display-node-labels").checked?e.target.ID:""},position:cyInvisible.getElementById(e.target.ID).position()}),cyLayout.add({group:"edges",data:{id:e.ID,source:e.source.ID,target:e.target.ID}})}catch(e){}})),cyLayout.layout({name:"fcose",randomize:!1,animate:!1}).run();var d=cyLayout.getElementById(e).boundingBox(),c=d.w,s=d.h;cyLayout.nodes().forEach((function(e){e.style("label",e.id())})),document.getElementsByName("cbk-flag-display-node-label-pos").forEach((function(e){e.checked&&a(e.value)})),null!=n&&(n.pngSizeProxyGraph=cyLayout.png({scale:2,full:!0})),cyLayout.remove(cyLayout.elements());var u=w(t.getElementById(e));t.nodes().unselect();var p=[];if(t.nodes().forEach((function(e){if(e.id()!=u.id()&&0==e.parent().length){e.isChildless()?e.select():C(e);var n=t.collection(t.$(":selected")).boundingBox(),a=(n=o(o({},n),{},{w:e.width(),h:e.height()})).w,i=n.h;p.push({id:e.id(),data:t.$(":selected"),pos:{x:(n.x2+n.x1)/2,y:(n.y1+n.y2)/2}});var r=cyLayout.add({group:"nodes",data:{id:e.id(),label:e.id()}});r.position({x:(n.x2+n.x1)/2,y:(n.y1+n.y2)/2}),r.style({width:Math.max(a,i),height:Math.max(a,i),label:document.getElementById("cbk-flag-display-node-labels").checked?r.data().id:""}),t.nodes().unselect()}})),0==t.getElementById(e).parent().length){var f=cyLayout.add(t.getElementById(e).clone());f.unselect(),f.position({x:t.getElementById(e).position().x,y:t.getElementById(e).position().y}),f.style({width:Math.max(c,s)+"px",height:Math.max(c,s)+"px","background-color":"#CCE1F9",label:document.getElementById("cbk-flag-display-node-labels").checked?f.data().id:""})}else{var y=cyLayout.add({group:"nodes",data:{id:u.id(),label:u.id()}});y.position({x:u.position().x,y:u.position().y}),y.style({label:document.getElementById("cbk-flag-display-node-labels").checked?y.data().id:""}),C(u);var g=t.$(":selected");t.nodes().unselect(),cyLayout.add(g),g.forEach((function(n){n.select();var a=t.collection(t.$(":selected")).boundingBox(),i=(a=o(o({},a),{},{w:n.width(),h:n.height()})).w,r=a.h;if(n.id()!=e)n.isChildless()&&(p.push({id:n.id(),data:t.$(":selected"),pos:{x:(a.x2+a.x1)/2,y:(a.y1+a.y2)/2}}),(y=cyLayout.getElementById(n.id())).position({x:(a.x2+a.x1)/2,y:(a.y1+a.y2)/2}),y.style({width:Math.max(i,r)+"px",height:Math.max(i,r)+"px",label:document.getElementById("cbk-flag-display-node-labels").checked?y.data().id:""}));else{var l=cyLayout.getElementById(n.id());l.position({x:n.position().x,y:n.position().y}),l.style({width:Math.max(c,s)+"px",height:Math.max(c,s)+"px","background-color":"#CCE1F9",label:document.getElementById("cbk-flag-display-node-labels").checked?l.data().id:""})}t.nodes().unselect()}))}t.fit(),cyLayout.layout({name:"fcose",quality:"proof",animate:!0,animationDuration:500,randomize:!1,nodeSeparation:25,fixedNodeConstraint:[{nodeId:e,position:{x:t.$("#"+e).position("x"),y:t.$("#"+e).position("y")}}]}).run(),p.forEach((function(t){var o,n,a,i,r,l,d=cyLayout.getElementById(t.id).boundingBox(),c={x:(d.x2+d.x1)/2,y:(d.y1+d.y2)/2},s=(o=t.pos,n=c,a=t.pos,i={x:n.x-o.x,y:n.y-o.y},{x:a.x+i.x,y:a.y+i.y}),u=(r=t.pos,{x:(l=s).x-r.x,y:l.y-r.y});t.data.forEach((function(t){D(t,u,e)}))})),t.fit(),t.getElementById(e).select()};function I(e){var t={edges:new Set,simpleNodes:[],compoundNodes:[]},o=e.child;o&&o.nodes.forEach((function(e){var o=I(e);for(var n in o)t[n]=[].concat(l(t[n]||[]),l(o[n]));t.edges=new Set(t.edges),e.child?t.compoundNodes.push(e):t.simpleNodes.push(e),e.edges.forEach((function(e){return t.edges.add(e)}))}));return t}function C(e){var t=e.children();t.nonempty()&&t.forEach((function(e){e.select(),C(e)}))}function w(e){return 0!=e.parent().length?w(e.parent()):e}function D(e,t,o){e.isChildless()&&e.id()!=o?e.animate({position:{x:e.position().x+t.x,y:e.position().y+t.y}},{duration:500}):e.children().forEach((function(e){D(e,t,o)}))}return x}var u,p,f=(u=Math.max,p=Date.now||function(){return(new Date).getTime()},function(e,t,o){var n,i,r,l,d,c,s,f,y,g=0,m=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");if(t=t<0?0:+t||0,!0===o){var v=!0;h=!1}else y=a(f=o),!f||"object"!=y&&"function"!=y||(v=!!o.leading,m="maxWait"in o&&u(+o.maxWait||0,t),h="trailing"in o?!!o.trailing:h);function b(t,o){o&&clearTimeout(o),i=c=s=void 0,t&&(g=p(),r=e.apply(d,n),c||i||(n=d=void 0))}function x(){var e=t-(p()-l);e<=0||e>t?b(s,i):c=setTimeout(x,e)}function E(){b(h,c)}function I(){if(n=arguments,l=p(),d=this,s=h&&(c||!v),!1===m)var o=v&&!c;else{i||v||(g=l);var a=m-(l-g),u=a<=0||a>m;u?(i&&(i=clearTimeout(i)),g=l,r=e.apply(d,n)):i||(i=setTimeout(E,a))}return u&&c?c=clearTimeout(c):c||t===m||(c=setTimeout(x,t)),o&&(u=!0,r=e.apply(d,n)),!u||c||i||(n=d=void 0),r}return I.cancel=function(){c&&clearTimeout(c),i&&clearTimeout(i),g=0,i=c=s=void 0},I}),y={name:"fcose",animate:!0,randomize:!1,stop:function(){initializer(cy)}};function g(e){var t=cy.nodes().filter((function(e){return e.isChildless()})),o=cyVisible.nodes().filter((function(e){return e.isChildless()})),n=cyInvisible.nodes().filter((function(e){return e.isChildless()})),a=cyLayout.nodes().filter((function(e){return e.isChildless()}));t.style("text-valign",e),o.style("text-valign",e),n.style("text-valign",e),a.style("text-valign",e)}function m(e,t,n){var i,r=e,l=function(){var e=t.scratch("_cyExpandCollapse");return e&&e.cueUtilities},d={init:function(){var e=document.createElement("canvas");e.classList.add("expand-collapse-canvas");var a=document.getElementById("cy"),r=e.getContext("2d");a.appendChild(e);var l=function(e){var t=e.getBoundingClientRect();return{top:t.top+document.documentElement.scrollTop,left:t.left+document.documentElement.scrollLeft}};function d(){var o=a.offsetWidth,n=a.offsetHeight,i=o*p.pixelRatio,r=n*p.pixelRatio;e.width=i,e.height=r,e.style.width="".concat(o,"px"),e.style.height="".concat(n,"px"),t.trigger("cyCanvas.resize")}t.on("resize",(function(){d()})),e.setAttribute("style","position:absolute; top:0; left:0; z-index:".concat(p().zIndex,";"));var s=f((function(){e.height=t.container().offsetHeight,e.width=t.container().offsetWidth,e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.zIndex=p().zIndex,setTimeout((function(){var o=l(e),n=l(a);e.style.top=-(o.top-n.top),e.style.left=-(o.left-n.left),t&&m()}),0)}),250);d();var u={};function p(){return t.scratch("cyComplexityManagement").options}function m(){var e=t.width(),o=t.height();r.clearRect(0,0,e,o),i=null}var h,v,b=(v=null,function(e,t,o,n,a){e!==v?((h=new Image(n,a)).src=e,h.onload=function(){r.drawImage(h,t,o,n,a),v=e}):r.drawImage(h,t,o,n,a)});t.on("resize",u.eCyResize=function(){s()}),t.on("expandcollapse.clearvisualcue",(function(){i&&m()}));var x=null,E=null;function I(e,t,o,n){e?t.layout(o).run():n(t)}t.on("mousedown",u.eMouseDown=function(e){x=e.renderedPosition||e.cyRenderedPosition}),t.on("mouseup",u.eMouseUp=function(e){E=e.renderedPosition||e.cyRenderedPosition}),t.on("remove","node",u.eRemove=function(e){e.target==i&&m()}),t.on("select unselect",u.eSelect=function(){i&&m();var e=t.nodes(":selected");if(1===e.length){var o=e[0];(n.isExpandable(o)||n.isCollapsible(o))&&function(e){var o,n=e.hasClass("cy-expand-collapse-collapsed-node"),a=p().expandCollapseCueSize,l=p().expandCollapseCueLineSize;if("top-left"===p().expandCollapseCuePosition){var d=t.zoom()<1?a/(2*t.zoom()):a/2,s=parseFloat(e.css("border-width"));o={x:e.position("x")-e.width()/2-parseFloat(e.css("padding-left"))+s+d+1,y:e.position("y")-e.height()/2-parseFloat(e.css("padding-top"))+s+d+1}}else{var u=p().expandCollapseCuePosition;o="function"==typeof u?u.call(this,e):u}var f=c(o),y=((a=Math.max(a,a*t.zoom()))-(l=Math.max(l,l*t.zoom())))/2,g=f.x,m=f.y,h=g-a/2,v=m-a/2,x=a;if(n&&p().expandCueImage)b(p().expandCueImage,h,v,a,a);else if(!n&&p().collapseCueImage)b(p().collapseCueImage,h,v,a,a);else{var E=r.fillStyle,I=r.lineWidth,C=r.strokeStyle;r.fillStyle="black",r.strokeStyle="black",r.ellipse(g,m,a/2,a/2,0,0,2*Math.PI),r.fill(),r.beginPath(),r.strokeStyle="white",r.lineWidth=Math.max(2.6,2.6*t.zoom()),r.moveTo(h+y,v+a/2),r.lineTo(h+l+y,v+a/2),n&&(r.moveTo(h+a/2,v+y),r.lineTo(h+a/2,v+l+y)),r.closePath(),r.stroke(),r.strokeStyle=C,r.fillStyle=E,r.lineWidth=I}e._private.data.expandcollapseRenderedStartX=h,e._private.data.expandcollapseRenderedStartY=v,e._private.data.expandcollapseRenderedCueSize=x,i=e}(o)}}),t.on("tap",u.eTap=function(e){var a=i;(function(e,t,o,n,a){if(!e)return!1;var i=e.data("expandcollapseRenderedStartX"),r=e.data("expandcollapseRenderedStartY"),l=e.data("expandcollapseRenderedCueSize"),d=i+l,c=r+l,s=t.renderedPosition||t.cyRenderedPosition,u=s.x,p=s.y,f=(o.expandCollapseCueSensitivity-1)/2;return Math.abs(n.x-a.x)<5&&Math.abs(n.y-a.y)<5&&u>=i-l*f&&u<=d+l*f&&p>=r-l*f&&p<=c+l*f})(a,e,p(),x,E)&&function(e,t,a,i,r,l,d){console.log("Called processCueTap"),e=o(o({},e),i.options().layout);var c=document.getElementById("cbk-run-layout3").checked,s=document.getElementById("cbk-flag-recursive").checked;if(n.isCollapsible(t))a(),n.collapseNodes([t],s),I(c,i,e,r);else if(n.isExpandable(t)){a(),console.log("[node]: ".concat([t]," cbkFlagRecursiveChecked: ").concat(s," cbkRunLayout3checked: ").concat(c," pngImage: ").concat(l," setLabelPosition: ").concat(d));try{n.expandNodes([t],s,c,l,d)}catch(e){console.error(e),console.log("couldn't expand nodes")}setTimeout((function(){a(),I(c,i,e,r)}),c?700:0)}}(y,a,m,t,initializer,pngImage,g)}),t.on("afterUndo afterRedo",u.eUndoRedo=u.eSelect),t.on("position","node",u.ePosition=u.eSelect),t.on("pan zoom",u.ePosition),u.hasEventFields=!0,function(e){var o=t.scratch("_cyExpandCollapse");null==o&&(o={}),o.cueUtilities=e,t.scratch("_cyExpandCollapse",o)}(u)},unbind:function(){var e=l();e.hasEventFields?(t.trigger("expandcollapse.clearvisualcue"),t.off("mousedown","node",e.eMouseDown).off("mouseup","node",e.eMouseUp).off("remove","node",e.eRemove).off("tap","node",e.eTap).off("add","node",e.eAdd).off("position","node",e.ePosition).off("pan zoom",e.ePosition).off("select unselect",e.eSelect).off("free","node",e.eFree).off("resize",e.eCyResize).off("afterUndo afterRedo",e.eUndoRedo)):console.log("events to unbind does not exist")},rebind:function(){var e=l();e.hasEventFields?t.on("mousedown","node",e.eMouseDown).on("mouseup","node",e.eMouseUp).on("remove","node",e.eRemove).on("tap","node",e.eTap).on("add","node",e.eAdd).on("position","node",e.ePosition).on("pan zoom",e.ePosition).on("select unselect",e.eSelect).on("free","node",e.eFree).on("resize",e.eCyResize).on("afterUndo afterRedo",e.eUndoRedo):console.log("events to rebind does not exist")}},c=function(e){var o=t.pan(),n=t.zoom();return{x:e.x*n+o.x,y:e.y*n+o.y}};if(d[r])return d[r].apply(t.container(),Array.prototype.slice.call(arguments,1));if("object"==a(r)||!r)return d.init.apply(t.container(),arguments);throw new Error("No such function `"+r+"` for cytoscape.js-expand-collapse")}function h(e){function t(e,t){void 0===e.scratch("cyComplexityManagement")&&e.scratch("cyComplexityManagement",{});var o=e.scratch("cyComplexityManagement");return void 0===t?o:o[t]}function o(e,o,n){t(e)[o]=n}e("core","complexityManagement",(function(e){var n=this,a={filterRule:function(e){return!1},cueEnabled:!0,expandCollapseCuePosition:"top-left",expandCollapseCueSize:12,expandCollapseCueLineSize:8,expandCueImage:void 0,collapseCueImage:void 0,expandCollapseCueSensitivity:1,zIndex:999};if("get"!==e){a=function(e,t){var o={};for(var n in e)o[n]=e[n];for(var n in t)o.hasOwnProperty(n)&&(o[n]=t[n]);return o}(a,e);var i=s(n),r=new Map;o(n,"options",a),o(n,"api",i),o(n,"removedEles",r),a.cueEnabled&&m(a,n,i)}return t(n,"api")}))}document.getElementsByName("cbk-flag-display-node-label-pos"),void 0!==window.cytoscape&&h(window.cytoscape);export{h as default};
